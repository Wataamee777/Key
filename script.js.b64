document.body.innerHTML = `
  <h2>🔐 暗号化ツール</h2>
  <textarea id="text" rows="4" placeholder="テキスト"></textarea><br>
  <input type="password" id="pass" placeholder="パスワード"><br>
  <button onclick="encrypt()">🔒 暗号化</button>
  <button onclick="decrypt()">🔓 復号化</button><br>
  <textarea id="result" rows="4" placeholder="結果" readonly></textarea>
`;

function salt(length = 16) {
  const chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
  return Array.from({ length }, () => chars[Math.floor(Math.random() * chars.length)]).join('');
}

function encode(pw) {
  return btoa(pw.split('').reverse().map((c, i) => String.fromCharCode(c.charCodeAt(0) + (i % 5))).join(''));
}

function decode(enc) {
  try {
    return atob(enc).split('').map((c, i) => String.fromCharCode(c.charCodeAt(0) - (i % 5))).reverse().join('');
  } catch {
    return null;
  }
}

function deriveKey(password, salt) {
  return CryptoJS.PBKDF2(password, salt, {
    keySize: 256 / 32,
    iterations: 100000
  });
}

function encrypt() {
  const text = document.getElementById("text").value;
  const pw = document.getElementById("pass").value;
  if (!text || !pw) return alert("入力不足");

  const s = salt();
  const key = deriveKey(pw, s);
  const iv = CryptoJS.lib.WordArray.random(16);
  const encrypted = CryptoJS.AES.encrypt(text, key, { iv }).toString();

  const obj = JSON.stringify({ iv: iv.toString(CryptoJS.enc.Hex), data: encrypted });
  const final = btoa(obj + "::" + s + "::" + encode(pw));
  document.getElementById("result").value = final;
}

function decrypt() {
  const enc = document.getElementById("text").value;
  if (!enc) return alert("暗号文を入力して");

  try {
    const [json, salt, encPw] = atob(enc).split("::");
    const pw = decode(encPw);
    const key = deriveKey(pw, salt);
    const data = JSON.parse(json);
    const iv = CryptoJS.enc.Hex.parse(data.iv);
    const decrypted = CryptoJS.AES.decrypt(data.data, key, { iv });
    const plain = decrypted.toString(CryptoJS.enc.Utf8);

    if (!plain) throw Error();
    document.getElementById("result").value = plain;
  } catch {
    alert("復号に失敗。パスワードか暗号文が間違ってる。");
  }
}
